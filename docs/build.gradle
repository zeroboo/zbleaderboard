/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
plugins {
  id 'org.ysb33r.rust.base'  version '0.2'  
  id 'org.ysb33r.rust.exe'  version '0.2'  
  ///id 'org.ysb33r.rust.lib'  version '0.2'  
}

subprojects {
    version = '1.0'
}

dependencies {
  rust {  
    compile 'svgblob_cli:0.3.2' 

    compile { 
    }

    test 'svgblob_cli:0.3.2' 

    test { 
    }

    build 'svgblob_cli:0.3.2' 

    build { 
    }
  }
}

rust {
  executable version : '1.2.3' 
  executable searchPath() 

  abiToolsSearchPath = [ '/bin', '/usr/bin' ] 
  abiToolsSearchPath 'bin', '/usr/bin' 
  
}
//apply plugin: "org.ysb33r.rust.exe"
//apply plugin: "org.ysb33r.rust.base"
///task buildDocument(type: org.ysb33r.gradle.rust.tasks.RustApplicationExec) {
task rustCheck() {
	doLast{
		println "cargo: ${rust.resolveCargoPath()}"
    println "rustc: ${rust.resolveRustcPath()}"
    project.tasks.collect { task -> println("task="+task+" dependsOn="+task.dependsOn) }
	}
}

task makeDiagram(type:Exec) {
  workingDir './'
  
  //on windows:
  ///executable 'start'
  ///args 'svgbob ./src/bob/overview.bob -o overview.svg'
  commandLine 'cmd','/c', 'svgbob ./src/bob/overview.bob -o overview.svg'

  //store the output instead of printing to the console:
  standardOutput = new ByteArrayOutputStream()
  errorOutput = new ByteArrayOutputStream()
  ext.stdout = {
      return standardOutput.toString()
  }
  ext.stderr = {
      return errorOutput.toString()
  }

  doLast{
    println standardOutput.toString()
    println errorOutput.toString()

  }
}